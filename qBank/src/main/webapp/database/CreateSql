-- 사용자
CREATE TABLE `USERS` (
  `UNO`        INTEGER      NOT NULL COMMENT '사용자번호', -- 사용자번호
  `UCLASS`     VARCHAR(100) NOT NULL COMMENT '사용자분류', -- 사용자분류
  `UID`        VARCHAR(50)  NOT NULL COMMENT '아이디', -- 아이디
  `UPASS`      VARCHAR(20)  NOT NULL COMMENT '비밀번호', -- 비밀번호
  `UNAME`      VARCHAR(50)  NOT NULL COMMENT '이름', -- 이름
  `UEMAIL`     VARCHAR(40)  NOT NULL COMMENT '이메일', -- 이메일
  `UADDR1`     VARCHAR(255) NULL     COMMENT '주소', -- 주소
  `UADDR2`     VARCHAR(255) NULL     COMMENT '상세주소', -- 상세주소
  `UZIPCODE`   VARCHAR(7)   NULL     COMMENT '우편번호', -- 우편번호
  `UTEL`       VARCHAR(30)  NULL     COMMENT '일반전화', -- 일반전화
  `UCELLPHONE` VARCHAR(30)  NOT NULL COMMENT '핸드폰', -- 핸드폰
  `UBIRTH`     VARCHAR(10)  NOT NULL COMMENT '생년월일', -- 생년월일
  `USEX`       VARCHAR(10)  NOT NULL COMMENT '성별', -- 성별
  `UPHOTOPATH` VARCHAR(255) NULL     COMMENT '사진경로' -- 사진경로
)
COMMENT '사용자';

-- 사용자
ALTER TABLE `USERS`
  ADD CONSTRAINT `PK_USERS` -- 사용자 기본키
    PRIMARY KEY (
      `UNO` -- 사용자번호
    );

-- 사용자 유니크 인덱스
CREATE UNIQUE INDEX `UIX_USERS`
  ON `USERS` ( -- 사용자
    `UID` ASC -- 아이디
  );

ALTER TABLE `USERS`
  MODIFY COLUMN `UNO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '사용자번호';

-- 강사
CREATE TABLE `TEACHER` (
  `UNO` INTEGER NOT NULL COMMENT '강사번호' -- 강사번호
)
COMMENT '강사';

-- 강사
ALTER TABLE `TEACHER`
  ADD CONSTRAINT `PK_TEACHER` -- 강사 기본키
    PRIMARY KEY (
      `UNO` -- 강사번호
    );

-- 학생
CREATE TABLE `STUDENT` (
  `UNO` INTEGER NOT NULL COMMENT '학생번호' -- 학생번호
)
COMMENT '학생';

-- 학생
ALTER TABLE `STUDENT`
  ADD CONSTRAINT `PK_STUDENT` -- 학생 기본키
    PRIMARY KEY (
      `UNO` -- 학생번호
    );

-- 관리자
CREATE TABLE `ADMIN` (
  `UNO` INTEGER NOT NULL COMMENT '관리자번호' -- 관리자번호
)
COMMENT '관리자';

-- 관리자
ALTER TABLE `ADMIN`
  ADD CONSTRAINT `PK_ADMIN` -- 관리자 기본키
    PRIMARY KEY (
      `UNO` -- 관리자번호
    );

-- 문제은행
CREATE TABLE `QBANK` (
  `QNO`      INTEGER      NOT NULL COMMENT '문제번호', -- 문제번호
  `QCODE`    VARCHAR(10)  NOT NULL COMMENT '문제코드', -- 문제코드
  `QTYPE`    VARCHAR(10)  NOT NULL COMMENT '문형', -- 문형
  `QLEVEL`   VARCHAR(10)  NOT NULL COMMENT '난이도', -- 난이도
  `QEDITUSE` INTEGER      NOT NULL COMMENT '에디터사용', -- 에디터사용
  `QNAME`    TEXT         NOT NULL COMMENT '문제명', -- 문제명
  `QTEXT`    TEXT         NULL     COMMENT '지문', -- 지문
  `QCOMMENT` TEXT         NULL     COMMENT '해설', -- 해설
  `QSOURCE`  VARCHAR(255) NULL     COMMENT '출처', -- 출처
  `QUSEYN`   INTEGER      NOT NULL COMMENT '사용유무', -- 사용유무
  `QWRITER`  VARCHAR(50)  NOT NULL COMMENT '작성자', -- 작성자
  `QDATE`    DATETIME     NOT NULL COMMENT '작성일', -- 작성일
  `CCODE`    INTEGER      NULL     COMMENT '분류번호' -- 분류번호
)
COMMENT '문제은행';

-- 문제은행
ALTER TABLE `QBANK`
  ADD CONSTRAINT `PK_QBANK` -- 문제은행 기본키
    PRIMARY KEY (
      `QNO` -- 문제번호
    );

-- 문제은행 유니크 인덱스
CREATE UNIQUE INDEX `UIX_QBANK`
  ON `QBANK` ( -- 문제은행
    `QCODE` ASC -- 문제코드
  );

ALTER TABLE `QBANK`
  MODIFY COLUMN `QNO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '문제번호';

-- 주관식
CREATE TABLE `SUBJECTIVE` (
  `QNO`     INTEGER      NOT NULL COMMENT '문제번호', -- 문제번호
  `SANSWER` VARCHAR(255) NOT NULL COMMENT '주관식정답' -- 주관식정답
)
COMMENT '주관식';

-- 주관식
ALTER TABLE `SUBJECTIVE`
  ADD CONSTRAINT `PK_SUBJECTIVE` -- 주관식 기본키
    PRIMARY KEY (
      `QNO` -- 문제번호
    );

ALTER TABLE `SUBJECTIVE`
  MODIFY COLUMN `QNO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '문제번호';

-- 객관식보기
CREATE TABLE `OBJECTIVE` (
  `ONO`     INTEGER      NOT NULL COMMENT '보기번호', -- 보기번호
  `ONAME`   VARCHAR(255) NULL     COMMENT '보기명', -- 보기명
  `OANSWER` VARCHAR(10)  NULL     COMMENT '정답', -- 정답
  `QNO`     INTEGER      NULL     COMMENT '문제번호' -- 문제번호
)
COMMENT '객관식보기';

-- 객관식보기
ALTER TABLE `OBJECTIVE`
  ADD CONSTRAINT `PK_OBJECTIVE` -- 객관식보기 기본키
    PRIMARY KEY (
      `ONO` -- 보기번호
    );

ALTER TABLE `OBJECTIVE`
  MODIFY COLUMN `ONO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '보기번호';

-- 문제분류
CREATE TABLE `CATEGORY` (
  `CCODE`   INTEGER      NOT NULL COMMENT '분류번호', -- 분류번호
  `CNAME`   VARCHAR(100) NOT NULL COMMENT '이름', -- 이름
  `CURL`    VARCHAR(255) NULL     COMMENT '링크주소', -- 링크주소
  `CPARENT` INTEGER      NULL     COMMENT '부모값', -- 부모값
  `CSEQ`    INTEGER      NOT NULL COMMENT '정렬번호', -- 정렬번호
  `CDEPTH`  INTEGER      NOT NULL COMMENT '분류깊이', -- 분류깊이
  `CUSEYN`  INTEGER      NOT NULL COMMENT '사용여부' -- 사용여부
)
COMMENT '문제분류';

-- 문제분류
ALTER TABLE `CATEGORY`
  ADD CONSTRAINT `PK_CATEGORY` -- 문제분류 기본키
    PRIMARY KEY (
      `CCODE` -- 분류번호
    );

ALTER TABLE `CATEGORY`
  MODIFY COLUMN `CCODE` INTEGER NOT NULL AUTO_INCREMENT COMMENT '분류번호';

-- 문제은행첨부항목
CREATE TABLE `FILE` (
  `FNO`   INTEGER      NOT NULL COMMENT '파일번호', -- 파일번호
  `QNO`   INTEGER      NOT NULL COMMENT '문제번호', -- 문제번호
  `FTYPE` VARCHAR(10)  NULL     COMMENT '타입', -- 타입
  `FPATH` VARCHAR(255) NULL     COMMENT '파일경로' -- 파일경로
)
COMMENT '문제은행첨부항목';

-- 문제은행첨부항목
ALTER TABLE `FILE`
  ADD CONSTRAINT `PK_FILE` -- 문제은행첨부항목 기본키
    PRIMARY KEY (
      `FNO` -- 파일번호
    );

ALTER TABLE `FILE`
  MODIFY COLUMN `FNO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '파일번호';

-- 서술형
CREATE TABLE `DISCRIPTIVE` (
  `QNO`     INTEGER NOT NULL COMMENT '문제번호', -- 문제번호
  `DANSWER` TEXT    NOT NULL COMMENT '서술형정답' -- 서술형정답
)
COMMENT '서술형';

-- 서술형
ALTER TABLE `DISCRIPTIVE`
  ADD CONSTRAINT `PK_DISCRIPTIVE` -- 서술형 기본키
    PRIMARY KEY (
      `QNO` -- 문제번호
    );

ALTER TABLE `DISCRIPTIVE`
  MODIFY COLUMN `QNO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '문제번호';

-- 시험지
CREATE TABLE `SETTING` (
  `SECODE`        VARCHAR(20)  NOT NULL COMMENT '시험지코드', -- 시험지코드
  `SENO`          INTEGER      NOT NULL COMMENT '세팅번호', -- 세팅번호
  `SETITLE`       VARCHAR(255) NOT NULL COMMENT '제목', -- 제목
  `SEQTY`         INTEGER      NOT NULL COMMENT '문제수', -- 문제수
  `SEQPOSITION`   INTEGER      NOT NULL COMMENT '문제배치', -- 문제배치
  `SETEXPOSITION` INTEGER      NOT NULL COMMENT '보기배치', -- 보기배치
  `SEUSEYN`       INTEGER      NOT NULL COMMENT '사용유무', -- 사용유무
  `SESTARTDATE`   VARCHAR(10)  NULL     COMMENT '시작날짜', -- 시작날짜
  `SEENDDATE`     VARCHAR(10)  NULL     COMMENT '끝날짜', -- 끝날짜
  `REGDATE`       INT(11)      NULL     COMMENT '등록날짜', -- 등록날짜
  `UNO2`          INTEGER      NULL     COMMENT '강사번호' -- 강사번호
)
COMMENT '시험지';

-- 시험지
ALTER TABLE `SETTING`
  ADD CONSTRAINT `PK_SETTING` -- 시험지 기본키
    PRIMARY KEY (
      `SECODE` -- 시험지코드
    );

-- 시험지 유니크 인덱스
CREATE UNIQUE INDEX `UIX_SETTING`
  ON `SETTING` ( -- 시험지
    `SENO` ASC -- 세팅번호
  );

ALTER TABLE `SETTING`
  MODIFY COLUMN `SENO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '세팅번호';

-- 시험지문항
CREATE TABLE `TEST` (
  `TNO`    INTEGER     NOT NULL COMMENT '시험지번호', -- 시험지번호
  `SECODE` VARCHAR(20) NULL     COMMENT '시험지코드', -- 시험지코드
  `QNO`    INTEGER     NULL     COMMENT '문제번호' -- 문제번호
)
COMMENT '시험지문항';

-- 시험지문항
ALTER TABLE `TEST`
  ADD CONSTRAINT `PK_TEST` -- 시험지문항 기본키
    PRIMARY KEY (
      `TNO` -- 시험지번호
    );

ALTER TABLE `TEST`
  MODIFY COLUMN `TNO` INTEGER NOT NULL AUTO_INCREMENT COMMENT '시험지번호';

-- 강사
ALTER TABLE `TEACHER`
  ADD CONSTRAINT `FK_USERS_TO_TEACHER` -- 사용자 -> 강사
    FOREIGN KEY (
      `UNO` -- 강사번호
    )
    REFERENCES `USERS` ( -- 사용자
      `UNO` -- 사용자번호
    );

-- 학생
ALTER TABLE `STUDENT`
  ADD CONSTRAINT `FK_USERS_TO_STUDENT` -- 사용자 -> 학생
    FOREIGN KEY (
      `UNO` -- 학생번호
    )
    REFERENCES `USERS` ( -- 사용자
      `UNO` -- 사용자번호
    );

-- 관리자
ALTER TABLE `ADMIN`
  ADD CONSTRAINT `FK_USERS_TO_ADMIN` -- 사용자 -> 관리자
    FOREIGN KEY (
      `UNO` -- 관리자번호
    )
    REFERENCES `USERS` ( -- 사용자
      `UNO` -- 사용자번호
    );

-- 문제은행
ALTER TABLE `QBANK`
  ADD CONSTRAINT `FK_CATEGORY_TO_QBANK` -- 문제분류 -> 문제은행
    FOREIGN KEY (
      `CCODE` -- 분류번호
    )
    REFERENCES `CATEGORY` ( -- 문제분류
      `CCODE` -- 분류번호
    );

-- 주관식
ALTER TABLE `SUBJECTIVE`
  ADD CONSTRAINT `FK_QBANK_TO_SUBJECTIVE` -- 문제은행 -> 주관식
    FOREIGN KEY (
      `QNO` -- 문제번호
    )
    REFERENCES `QBANK` ( -- 문제은행
      `QNO` -- 문제번호
    );

-- 객관식보기
ALTER TABLE `OBJECTIVE`
  ADD CONSTRAINT `FK_QBANK_TO_OBJECTIVE` -- 문제은행 -> 객관식보기
    FOREIGN KEY (
      `QNO` -- 문제번호
    )
    REFERENCES `QBANK` ( -- 문제은행
      `QNO` -- 문제번호
    );

-- 문제은행첨부항목
ALTER TABLE `FILE`
  ADD CONSTRAINT `FK_QBANK_TO_FILE` -- 문제은행 -> 문제은행첨부항목
    FOREIGN KEY (
      `QNO` -- 문제번호
    )
    REFERENCES `QBANK` ( -- 문제은행
      `QNO` -- 문제번호
    );

-- 서술형
ALTER TABLE `DISCRIPTIVE`
  ADD CONSTRAINT `FK_QBANK_TO_DISCRIPTIVE` -- 문제은행 -> 서술형
    FOREIGN KEY (
      `QNO` -- 문제번호
    )
    REFERENCES `QBANK` ( -- 문제은행
      `QNO` -- 문제번호
    );

-- 시험지
ALTER TABLE `SETTING`
  ADD CONSTRAINT `FK_TEACHER_TO_SETTING` -- 강사 -> 시험지
    FOREIGN KEY (
      `UNO2` -- 강사번호
    )
    REFERENCES `TEACHER` ( -- 강사
      `UNO` -- 강사번호
    );

-- 시험지문항
ALTER TABLE `TEST`
  ADD CONSTRAINT `FK_QBANK_TO_TEST` -- 문제은행 -> 시험지문항
    FOREIGN KEY (
      `QNO` -- 문제번호
    )
    REFERENCES `QBANK` ( -- 문제은행
      `QNO` -- 문제번호
    );

-- 시험지문항
ALTER TABLE `TEST`
  ADD CONSTRAINT `FK_SETTING_TO_TEST` -- 시험지 -> 시험지문항
    FOREIGN KEY (
      `SECODE` -- 시험지코드
    )
    REFERENCES `SETTING` ( -- 시험지
      `SECODE` -- 시험지코드
    );